<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>IMBIE Submission Report</title>
    <style>
html {
  background: #aaa;
}
body {
  background: white;
  margin: 2cm auto;
  width: 21cm;
  height: 29.7cm;
}
main {
  display: grid;
  grid-template: 1fr 400px / 1fr 1fr;
  grid-template-areas:
    "plots plots"
    "stats coverage";
  gap: 2rem;
}
.section__plots {
  grid-area: plots;
}
.section__stats {
  grid-area: stats;
}
.section__coverage {
  grid-area: coverage;
}
header {
  display: grid;
  grid-template: auto 1fr / 1fr 1fr;
  grid-template-areas: 
    "title title"
    "left right";
  gap: 2rem;
}
.header-title {
  grid-area: title;
}
.header-left {
  grid-area: left;
}
.header-right {
  grid-area: right;
}
#plot {
  max-width: 100%;
  margin: 0 auto;
}
table {
  font-size: 8pt;
}
    </style>
  </head>
  <body>
    <header>
      <h1 class="header header-title">IMBIE Submission Report</h1>
      <div class="header header-left">
        <h2>{{ submission.username }}</h2>
        <p>{{ submission.institute }}</p>
      </div>
      <div class="header header-right">
        <h2>{{ submission.experiment_group }}</h2>
      </div>
    </header>
    <main>
      <section class="section__plots">
        <h3>Data plots</h3>
        <img id="plot" src="{{ graph }}" alt="submission data plots"/>
      </section>
      <section class="section__stats">
        <h3>Statistics</h3>
        <table class="table table-striped table-bordered table-sm">
          <thead>
            <tr class="text-center">
              <td></td>
              <th colspan="6">dM</th>
              <th colspan="6">dM/dt</th>
            </tr>
            <tr>
              <td><!-- spacing --></td>
              <th>Data</th>
              <th>Start Date</th>
              <th>Stop Date</th>
              <th>Mean Interval</th>
              <th>Total dM</th>
              <th>Mean dM/dt</th>
              <th>Data</th>
              <th>Start Date</th>
              <th>Stop Date</th>
              <th>Mean Interval</th>
              <th>Total dM</th>
              <th>Mean dM/dt</th> 
            </tr>
          </thead>
          <tbody class="table-group-divider">
            {% for basin in basins %}
            <tr>
              <th>{{ basin["basin"].value }}</th>
              {% for mode in "dm", "dmdt" %}
              {% if basin[mode] %}
              <td>✔</td>
              <td>{{ basin[mode].start_date.strftime("%Y-%m-%d")}}</td>
              <td>{{ basin[mode].stop_date.strftime("%Y-%m-%d")}}</td>
              <td>{{ basin[mode].interval.days }}&nbsp;days</td>
              <td>{{ "%.2f" % basin[mode].total_dm }}&nbsp;Gt</td>
              <td>{{ "%.2f" % basin[mode].mean_dmdt }}&nbsp;Gt/yr</td>
              {% else %}
              <td>✘</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              {% endif %}
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <!-- <table class="table table-striped">
          <tr>
            <th>Start Date</th>
            <td>{{ statistics.start.strftime("%Y-%m-%d") or "????-??-??" }}</td>
          </tr>
          <tr>
            <th>End Date</th>
            <td>{{ statistics.end.strftime("%Y-%m-%d") or "????-??-??" }}</td>
          </tr>
          <tr>
            <th>Duration</th>
            <td>{{ statistics.duration.days or "?" }} days</td>
          </tr>
          <tr>
            <th>Mean Sampling Interval</th>
            <td>{{ statistics.interval.days or "?" }} days</td>
          </tr>
          <tr>
            <th>Mean dM/dt</th>
            <td>{{ statistics.dmdt or "?" }} (Gt/yr)</td>
          </tr>
        </table>
      </section>
      <section class="section__coverage">
        <h3>Coverage</h3>
        <table class="table table-striped">
          <tr>
            <td></td>
            <th>dM</th>
            <th>dM/dt</th>
          </tr>
          {% for basin in basins %}
          <tr>
            <th>{{ basin["basin"].value }}</th>
            <td>{{ "✓" if basin["dm"] else "X" }}</td>
            <td>{{ "✓" if basin["dmdt"] else "X" }}</td>
          </tr>
          {% endfor %}
        </table>
      </section> -->
    </main>
  </body>
</html>